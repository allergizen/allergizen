{"version":3,"sources":["PortalContext.tsx"],"names":["React","createContext","useContext","useEffect","useMemo","useState","StyleSheet","View","PortalContext","usePortalContext","portal","Error","PortalProvider","children","portals","setPortals","Outlet","map","key","absoluteFill","Portal","_key","Date","now","Math","random","filter","p"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAAyDC,UAAzD,EAAqEC,SAArE,EAAgFC,OAAhF,EAAyFC,QAAzF,QAAyG,OAAzG;AACA,SAASC,UAAT,EAAqBC,IAArB,QAAiC,cAAjC;AAEA,OAAO,MAAMC,aAAa,gBAAGP,aAAa,CAGhC,IAHgC,CAAnC;AAKP,OAAO,MAAMQ,gBAAgB,GAAG,MAAM;AACpC,QAAMC,MAAM,GAAGR,UAAU,CAACM,aAAD,CAAzB;;AACA,MAAI,CAACE,MAAL,EAAa;AACX,UAAM,IAAIC,KAAJ,CAAU,sDAAV,CAAN;AACD;;AACD,SAAOD,MAAP;AACD,CANM;AAQP,OAAO,MAAME,cAAwB,GAAG,QAAkB;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AACxD,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBV,QAAQ,CAAgB,EAAhB,CAAtC;AAEA,sBAAO,oBAAC,aAAD,CAAe,QAAf;AAAwB,IAAA,KAAK,EAAE;AAAES,MAAAA,OAAF;AAAWC,MAAAA;AAAX;AAA/B,KAAyDF,QAAzD,CAAP;AACD,CAJM;AAMP,OAAO,MAAMG,MAAgB,GAAG,MAAM;AACpC,QAAM;AAAEF,IAAAA;AAAF,MAAcL,gBAAgB,EAApC;AAEA,sBACE,oBAAC,KAAD,CAAO,QAAP,QACGK,OAAO,CAACG,GAAR,CAAY;AAAA,QAAC;AAAEC,MAAAA,GAAF;AAAOL,MAAAA;AAAP,KAAD;AAAA,wBACX,oBAAC,IAAD;AAAM,MAAA,GAAG,EAAEK,GAAX;AAAgB,MAAA,aAAa,EAAC,UAA9B;AAAyC,MAAA,KAAK,EAAEZ,UAAU,CAACa;AAA3D,OACGN,QADH,CADW;AAAA,GAAZ,CADH,CADF;AASD,CAZM;AAoBP,OAAO,MAAMO,MAA6B,GAAG,SAAuB;AAAA,MAAtB;AAAEF,IAAAA,GAAF;AAAOL,IAAAA;AAAP,GAAsB;AAClE,QAAM;AAAEE,IAAAA;AAAF,MAAiBN,gBAAgB,EAAvC;;AAEA,QAAMY,IAAI,GAAGjB,OAAO,CAAC,MAAMc,GAAN,aAAMA,GAAN,cAAMA,GAAN,GAAc,GAAEI,IAAI,CAACC,GAAL,KAAaC,IAAI,CAACC,MAAL,EAAc,EAA5C,EAA+C,CAACP,GAAD,CAA/C,CAApB;;AAEAf,EAAAA,SAAS,CAAC,MAAM;AACdY,IAAAA,UAAU,CAAED,OAAD,IAAa,CAAC,GAAGA,OAAJ,EAAa;AAAEI,MAAAA,GAAG,EAAEG,IAAP;AAAaR,MAAAA;AAAb,KAAb,CAAd,CAAV;AAEA,WAAO,MAAM;AACXE,MAAAA,UAAU,CAAED,OAAD,IAAaA,OAAO,CAACY,MAAR,CAAgBC,CAAD,IAAOA,CAAC,CAACT,GAAF,KAAUG,IAAhC,CAAd,CAAV;AACD,KAFD;AAGD,GANQ,EAMN,CAACA,IAAD,EAAON,UAAP,EAAmBF,QAAnB,CANM,CAAT;AAQA,SAAO,IAAP;AACD,CAdM","sourcesContent":["import React, { createContext, Dispatch, SetStateAction, useContext, useEffect, useMemo, useState } from 'react';\nimport { StyleSheet, View } from 'react-native';\n\nexport const PortalContext = createContext<{\n  portals: PortalProps[];\n  setPortals: Dispatch<SetStateAction<PortalProps[]>>;\n} | null>(null);\n\nexport const usePortalContext = () => {\n  const portal = useContext(PortalContext);\n  if (!portal) {\n    throw new Error('usePortalContext must be used within a PortalContext');\n  }\n  return portal;\n};\n\nexport const PortalProvider: React.FC = ({ children }) => {\n  const [portals, setPortals] = useState<PortalProps[]>([]);\n\n  return <PortalContext.Provider value={{ portals, setPortals }}>{children}</PortalContext.Provider>;\n};\n\nexport const Outlet: React.FC = () => {\n  const { portals } = usePortalContext();\n\n  return (\n    <React.Fragment>\n      {portals.map(({ key, children }) => (\n        <View key={key} pointerEvents=\"box-none\" style={StyleSheet.absoluteFill}>\n          {children}\n        </View>\n      ))}\n    </React.Fragment>\n  );\n};\n\nexport interface PortalProps {\n  key?: React.Key;\n\n  children?: React.ReactNode;\n}\n\nexport const Portal: React.FC<PortalProps> = ({ key, children }) => {\n  const { setPortals } = usePortalContext();\n\n  const _key = useMemo(() => key ?? `${Date.now() + Math.random()}`, [key]);\n\n  useEffect(() => {\n    setPortals((portals) => [...portals, { key: _key, children }]);\n\n    return () => {\n      setPortals((portals) => portals.filter((p) => p.key !== _key));\n    };\n  }, [_key, setPortals, children]);\n\n  return null;\n};\n"]}